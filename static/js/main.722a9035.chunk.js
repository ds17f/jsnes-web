(this["webpackJsonpjsnes-web"]=this["webpackJsonpjsnes-web"]||[]).push([[0],{45:function(e,t,n){e.exports=n(78)},57:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(16),o=n.n(a),r=n(0),l=n.n(r),i=n(20),s=n.n(i),c=n(7),d=n(8),u=n(13),h=n(12),p=n(29),m=n(18),f=n(9),v=(n(57),n(79)),g={ROMS:{owlia:{name:"The Legends of Owlia",description:l.a.createElement("span",null,l.a.createElement("a",{href:"http://www.gradualgames.com/p/the-legends-of-owlia_1.html",target:"_blank",rel:"noopener noreferrer"},"Owlia by Gradual Games")," ","/"," ",l.a.createElement("a",{href:"http://www.infiniteneslives.com/owlia.php",target:"_blank",rel:"noopener noreferrer"},"Buy the cartridge")),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/owlia.nes"},nomolos:{name:"Nomolos: Storming the Catsle",description:l.a.createElement("span",null,l.a.createElement("a",{href:"http://www.gradualgames.com/p/nomolos-storming-catsle.html",target:"_blank",rel:"noopener noreferrer"},"Monolos by Gradual Games")," ","/"," ",l.a.createElement("a",{href:"http://www.infiniteneslives.com/nomolos.php",target:"_blank",rel:"noopener noreferrer"},"Buy the cartridge")),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/nomolos.nes"},croom:{name:"Concentration Room",description:l.a.createElement("span",null,l.a.createElement("a",{href:"http://www.pineight.com/croom/README",target:"_blank",rel:"noopener noreferrer"},"Concentration Room")," ","by Damian Yerrick"),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/croom/croom.nes"},lj65:{name:"LJ65",description:l.a.createElement("span",null,l.a.createElement("a",{href:"http://harddrop.com/wiki/LJ65",target:"_blank",rel:"noopener noreferrer"},"Concentration Room")," ","by Damian Yerrick"),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/lj65/lj65.nes"}},GOOGLE_ANALYTICS_CODE:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_GOOGLE_ANALYTICS_CODE,SENTRY_URI:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SENTRY_URI,BASENAME:function(){var e=window.location.href;if(e.includes("github.io")){var t=e.split("/");return"/".concat(t[3])}return""}},y={getRomInfoByHash:function(e){return this.load().find((function(t){return t.hash===e}))},save:function(e){return function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=t,a.readAsBinaryString(e)}))}(e).then((function(e){var t=e.target.result;return function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return crypto.subtle.digest("SHA-1",t).then((function(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")}))}(t).then((function(e){return{hash:e,byteString:t}}))})).then((function(t){var n=t.hash,a=t.byteString,o=localStorage.getItem("savedRomInfo"),r=o?JSON.parse(o):[],l={name:e.name,hash:n,added:Date.now()},i=JSON.stringify(r.concat([l]));return localStorage.setItem("savedRomInfo",i),localStorage.setItem("blob-"+n,a),l}))},load:function(){return localStorage.getItem("savedRomInfo")&&JSON.parse(localStorage.getItem("savedRomInfo"))||[]},delete:function(e){var t=this.load();localStorage.removeItem("blob-"+e),localStorage.setItem("savedRomInfo",JSON.stringify(t.filter((function(t){return t.hash!==e}))))}},C=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).deleteRom=function(e){y.delete(e),a.updateLibrary()},a.updateLibrary=function(){a.setState({romLibrary:y.load()})},a.handleDragOver=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},a.handleDrop=function(e){e.preventDefault();var t=e.dataTransfer.items?e.dataTransfer.items[0].getAsFile():e.dataTransfer.files[0];y.save(t).then((function(e){a.updateLibrary(),a.props.history.push({pathname:+e.hash})}))},a.state={romLibrary:y.load()},a}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"drop-zone",onDragOver:this.handleDragOver,onDrop:this.handleDrop},l.a.createElement("div",{className:"container ListPage py-4"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("header",{className:"mb-4"},l.a.createElement("h1",{className:"mb-3"},"JSNES"),l.a.createElement("p",null,"A JavaScript NES emulator."," ",l.a.createElement("a",{href:"https://github.com/bfirsh/jsnes"},"Source on GitHub."))),l.a.createElement(v.a,{className:"mb-4"},Object.keys(g.ROMS).sort().map((function(e){return l.a.createElement(m.b,{key:e,to:"/run/"+encodeURIComponent(e),className:"list-group-item"},g.ROMS[e].name,l.a.createElement("span",{className:"float-right"},"\u203a"))}))),l.a.createElement("p",null,"Or, drag and drop a ROM file onto the page to play it. (Google may help you find them.)"),this.state.romLibrary.length>0?l.a.createElement("div",null,l.a.createElement("p",null,"Previously played:"),l.a.createElement(v.a,{className:"mb-4"},this.state.romLibrary.sort((function(e,t){return new Date(t.added)-new Date(e.added)})).map((function(t){return l.a.createElement(m.b,{key:t.hash,to:"/local-"+t.hash,className:"list-group-item"},t.name,l.a.createElement("span",{onClick:function(n){n.preventDefault(),e.deleteRom(t.hash)},className:"delete",title:"Delete"},"\xd7"),l.a.createElement("span",{className:"float-right"},"\u203a"))})))):null))))}}]),n}(r.Component),E=n(84),b=n(85),T=n(22),w=n(44),B=n(27),k=n(17),O=n(86),S=n(80),N=n(81),D=n(82),F=n(83),U=n(2),M=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={playerOneButton:"",playerTwoButton:"",waitingForKey:0},a.handleClick=a.handleClick.bind(Object(k.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.keys,t=this.props.button,n=[];for(var a in e)1===e[a][0]&&e[a][1]===t?(n[0]=e[a][2],console.log(n[0])):2===e[a][0]&&e[a][1]===t&&(n[1]=e[a][2]);this.setState({playerOneButton:n[0],playerTwoButton:n[1]})}},{key:"componentDidUpdate",value:function(e,t){var n,a,o=this.props.keys,r=this.props.button,l=[];for(var i in o)1===o[i][0]&&o[i][1]===r?(l[0]=o[i][2],console.log(l[0])):2===o[i][0]&&o[i][1]===r&&(l[1]=o[i][2]);var s=function(e,t){return e.buttons.filter((function(e){return e.buttonId===t}))[0]},c=function(e,t){return t.buttons.filter((function(t){return!e||!e.buttons.some((function(e){return e.buttonId===t.buttonId}))}))[0]},d=0,u=0,h=function(e){return"button"===e.type?"Btn-"+e.code:"axis"===e.type?"Axis-"+e.code+" "+e.value:void 0};if(this.props.gamepadConfig&&this.props.gamepadConfig.playerGamepadId){var p=this.props.gamepadConfig.playerGamepadId;p[0]&&(l[0]="",n=s(this.props.gamepadConfig.configs[p[0]],r),a=c(e.gamepadConfig.configs[p[0]],this.props.gamepadConfig.configs[p[0]]),n?l[0]=h(n):a&&a.buttonId===this.props.prevButton&&(d||(d=1,u=1))),p[1]&&(l[1]="",n=s(this.props.gamepadConfig.configs[p[1]],r),a=c(e.gamepadConfig.configs[p[1]],this.props.gamepadConfig.configs[p[1]]),n?l[1]=h(n):a&&a.buttonId===this.props.prevButton&&(d||(d=2,u=2)))}var m={};d&&this.props.handleClick([u,this.props.button]),t.playerOneButton===l[0]&&t.playerTwoButton===l[1]||(m.playerOneButton=l[0],m.playerTwoButton=l[1]),d?m.waitingForKey=d:1===t.waitingForKey?this.props.currentPromptButton!==this.props.button&&(m.waitingForKey=0):2===t.waitingForKey&&this.props.currentPromptButton!==this.props.button&&(m.waitingForKey=0),Object.keys(m).length>0&&this.setState(m)}},{key:"handleClick",value:function(e){this.props.handleClick([e,this.props.button]),this.setState({waitingForKey:e})}},{key:"render",value:function(){var e=this;return l.a.createElement("tr",null,l.a.createElement("td",null,this.props.buttonName),l.a.createElement("td",{onClick:function(){return e.handleClick(1)}},1===this.state.waitingForKey?"Press key or button...":this.state.playerOneButton),l.a.createElement("td",{onClick:function(){return e.handleClick(2)}},2===this.state.waitingForKey?"Press key or button...":this.state.playerTwoButton))}}]),n}(r.Component),P="../img/nes_controller.png",A=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={gamepadConfig:e.gamepadConfig,keys:e.keys,button:void 0,modified:!1},a.handleKeyDown=a.handleKeyDown.bind(Object(k.a)(a)),a.handleGamepadButtonDown=a.handleGamepadButtonDown.bind(Object(k.a)(a)),a.listenForKey=a.listenForKey.bind(Object(k.a)(a)),a.state.gamepadConfig=a.state.gamepadConfig||{},a.state.gamepadConfig.playerGamepadId=a.state.gamepadConfig.playerGamepadId||[null,null],a.state.gamepadConfig.configs=a.state.gamepadConfig.configs||{},a.state.controllerIcon=a.state.gamepadConfig.playerGamepadId.map((function(e){return e?P:"../img/keyboard.png"})),a.state.controllerIconAlt=a.state.gamepadConfig.playerGamepadId.map((function(e){return e?"gamepad":"keyboard"})),a.state.currentPromptButton=-1,a}return Object(d.a)(n,[{key:"componentWillUnmount",value:function(){this.state.modified&&(this.props.setKeys(this.state.keys),this.props.setGamepadConfig(this.state.gamepadConfig)),this.removeKeyListener()}},{key:"listenForKey",value:function(e){var t=e[1];this.removeKeyListener(),this.setState({button:e,currentPromptButton:t}),this.props.promptButton(this.handleGamepadButtonDown),document.addEventListener("keydown",this.handleKeyDown)}},{key:"handleGamepadButtonDown",value:function(e){this.removeKeyListener();var t=this.state.button,n=t[0],a=t[1],o=e.gamepadId,r=this.state.gamepadConfig,l=r.playerGamepadId.slice(0),i={};l[n-1]=o;var s={code:e.code,type:e.type,buttonId:a,value:e.value};i[o]={buttons:(r.configs[o]||{buttons:[]}).buttons.filter((function(e){return e.buttonId!==a})).concat([s])};var c=Object.assign({},r.configs,i);this.setState({gamepadConfig:{configs:c,playerGamepadId:l},currentPromptButton:-1,controllerIcon:l.map((function(e){return e?P:"../img/keyboard.png"})),modified:!0})}},{key:"handleKeyDown",value:function(e){this.removeKeyListener();var t=this.state.button,n=this.state.keys,a={};for(var o in n)n[o][0]===t[0]&&n[o][1]===t[1]||(a[o]=n[o]);var r=this.state.gamepadConfig.playerGamepadId.slice(0);r[t[0]-1]=null,this.setState({keys:Object(B.a)(Object(B.a)({},a),{},Object(T.a)({},e.keyCode,[].concat(Object(w.a)(t.slice(0,2)),[e.key.length>1?e.key:String(e.key).toUpperCase()]))),button:void 0,gamepadConfig:{configs:this.state.gamepadConfig.configs,playerGamepadId:r},currentPromptButton:-1,controllerIcon:r.map((function(e){return e?P:"../img/keyboard.png"})),controllerIconAlt:r.map((function(e){return e?"gamepad":"keyboard"})),modified:!0})}},{key:"removeKeyListener",value:function(){this.props.promptButton(null),document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return l.a.createElement(O.a,{isOpen:this.props.isOpen,toggle:this.props.toggle,className:"ControlsModal"},l.a.createElement(S.a,{toggle:this.props.toggle},"Controls"),l.a.createElement(N.a,null,l.a.createElement(D.a,null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Button"),l.a.createElement("th",null,"Player 1",l.a.createElement("img",{className:"controller-icon",src:this.state.controllerIcon[0],alt:this.state.controllerIconAlt[0]})),l.a.createElement("th",null,"Player 2",l.a.createElement("img",{className:"controller-icon",src:this.state.controllerIcon[1],alt:this.state.controllerIconAlt[1]})))),l.a.createElement("tbody",null,l.a.createElement(M,{buttonName:"Left",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_LEFT,prevButton:U.Controller.BUTTON_SELECT,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"Right",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_RIGHT,prevButton:U.Controller.BUTTON_LEFT,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"Up",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_UP,prevButton:U.Controller.BUTTON_RIGHT,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"Down",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_DOWN,prevButton:U.Controller.BUTTON_UP,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"A",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_A,prevButton:U.Controller.BUTTON_DOWN,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"B",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_B,prevButton:U.Controller.BUTTON_A,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"Start",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_START,prevButton:U.Controller.BUTTON_B,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),l.a.createElement(M,{buttonName:"Select",currentPromptButton:this.state.currentPromptButton,button:U.Controller.BUTTON_SELECT,prevButton:U.Controller.BUTTON_START,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig})))),l.a.createElement(F.a,null,l.a.createElement(E.a,{outline:!0,color:"primary",onClick:this.props.toggle},"Close")))}}]),n}(r.Component),I=function(){function e(t){var n=this;Object(c.a)(this,e),this.onAnimationFrame=function(e){n.requestAnimationFrame();var t=e%n.interval,a=e-t;if(n.lastFrameTime){var o=Math.round((a-n.lastFrameTime)/n.interval);if(0!==o){n.generateFrame(),n.onWriteFrame();for(var r=n.interval-t,l=1;l<o;l++)setTimeout((function(){n.generateFrame()}),l*r/o);o>1&&console.log("SKIP",o-1,n.lastFrameTime)}}else n.lastFrameTime=a},this.onGenerateFrame=t.onGenerateFrame,this.onWriteFrame=t.onWriteFrame,this.onAnimationFrame=this.onAnimationFrame.bind(this),this.running=!0,this.interval=1e3/60.098,this.lastFrameTime=!1}return Object(d.a)(e,[{key:"start",value:function(){this.running=!0,this.requestAnimationFrame()}},{key:"stop",value:function(){this.running=!1,this._requestID&&window.cancelAnimationFrame(this._requestID),this.lastFrameTime=!1}},{key:"requestAnimationFrame",value:function(){this._requestID=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"generateFrame",value:function(){this.onGenerateFrame(),this.lastFrameTime+=this.interval}}]),e}(),_=Object(d.a)((function e(t){var n=this;Object(c.a)(this,e),this.disableIfGamepadEnabled=function(e){var t=n;return function(n,a){if(!t.gamepadConfig)return e(n,a);var o=t.gamepadConfig.playerGamepadId;return o&&o[n-1]?void 0:e(n,a)}},this._getPlayerNumberFromGamepad=function(e){return n.gamepadConfig.playerGamepadId[0]===e.id?1:n.gamepadConfig.playerGamepadId[1]===e.id?2:1},this.poll=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads(),t=[],a=0;a<e.length;a++){var o=e[a],r=n.gamepadState[a];if(o)if(r){var l=o.buttons,i=r.buttons;if(n.buttonCallback){for(var s=0;s<o.axes.length;s++){var c=o.axes[s],d=r.axes[s];-1===c&&-1!==d&&n.buttonCallback({gamepadId:o.id,type:"axis",code:s,value:c}),1===c&&1!==d&&n.buttonCallback({gamepadId:o.id,type:"axis",code:s,value:c})}for(var u=0;u<l.length;u++){var h=l[u],p=i[u];h.pressed&&!p.pressed&&n.buttonCallback({gamepadId:o.id,type:"button",code:u})}}else if(n.gamepadConfig){var m=n._getPlayerNumberFromGamepad(o);if(t.length<2&&(-1!==t.indexOf(m)&&++m>2&&(m=1),t.push(m),n.gamepadConfig.configs[o.id]))for(var f=n.gamepadConfig.configs[o.id].buttons,v=0;v<f.length;v++){var g=f[v];if("button"===g.type){var y=g.code,C=l[y],E=i[y];C.pressed&&!E.pressed?n.onButtonDown(m,g.buttonId):!C.pressed&&E.pressed&&n.onButtonUp(m,g.buttonId)}else if("axis"===g.type){var b=g.code,T=o.axes[b],w=r.axes[b];T===g.value&&w!==g.value&&n.onButtonDown(m,g.buttonId),T!==g.value&&w===g.value&&n.onButtonUp(m,g.buttonId)}}}n.gamepadState[a]={buttons:l.map((function(e){return{pressed:e.pressed}})),axes:o.axes.slice(0)}}else n.gamepadState[a]=o}},this.promptButton=function(e){n.buttonCallback=e?function(t){n.buttonCallback=null,e(t)}:e},this.loadGamepadConfig=function(){var e;try{(e=localStorage.getItem("gamepadConfig"))&&(e=JSON.parse(e))}catch(t){console.log("Failed to get gamepadConfig from localStorage.",t)}n.gamepadConfig=e},this.setGamepadConfig=function(e){try{localStorage.setItem("gamepadConfig",JSON.stringify(e)),n.gamepadConfig=e}catch(t){console.log("Failed to set gamepadConfig in localStorage")}},this.startPolling=function(){if(!navigator.getGamepads&&!navigator.webkitGetGamepads)return{stop:function(){}};var e=!1;return requestAnimationFrame((function t(){e||(n.poll(),requestAnimationFrame(t))})),{stop:function(){e=!0}}},this.onButtonDown=t.onButtonDown,this.onButtonUp=t.onButtonUp,this.gamepadState=[],this.buttonCallback=null})),H={88:[1,U.Controller.BUTTON_A,"X"],89:[1,U.Controller.BUTTON_B,"Y"],90:[1,U.Controller.BUTTON_B,"Z"],17:[1,U.Controller.BUTTON_SELECT,"Right Ctrl"],13:[1,U.Controller.BUTTON_START,"Enter"],38:[1,U.Controller.BUTTON_UP,"Up"],40:[1,U.Controller.BUTTON_DOWN,"Down"],37:[1,U.Controller.BUTTON_LEFT,"Left"],39:[1,U.Controller.BUTTON_RIGHT,"Right"],103:[2,U.Controller.BUTTON_A,"Num-7"],105:[2,U.Controller.BUTTON_B,"Num-9"],99:[2,U.Controller.BUTTON_SELECT,"Num-3"],97:[2,U.Controller.BUTTON_START,"Num-1"],104:[2,U.Controller.BUTTON_UP,"Num-8"],98:[2,U.Controller.BUTTON_DOWN,"Num-2"],100:[2,U.Controller.BUTTON_LEFT,"Num-4"],102:[2,U.Controller.BUTTON_RIGHT,"Num-6"]},R=Object(d.a)((function e(t){var n=this;Object(c.a)(this,e),this.loadKeys=function(){var e;try{(e=localStorage.getItem("keys"))&&(e=JSON.parse(e))}catch(t){console.log("Failed to get keys from localStorage.",t)}n.keys=e||H},this.setKeys=function(e){try{localStorage.setItem("keys",JSON.stringify(e)),n.keys=e}catch(t){console.log("Failed to set keys in localStorage")}},this.handleKeyDown=function(e){var t=n.keys[e.keyCode];t&&(n.onButtonDown(t[0],t[1]),e.preventDefault())},this.handleKeyUp=function(e){var t=n.keys[e.keyCode];t&&(n.onButtonUp(t[0],t[1]),e.preventDefault())},this.handleKeyPress=function(e){e.preventDefault()},this.onButtonDown=t.onButtonDown,this.onButtonUp=t.onButtonUp})),L=(n(73),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).setBuffer=function(t){for(var n=0,a=0;a<240;++a)for(var o=0;o<256;++o)n=256*a+o,e.buf32[n]=4278190080|t[n]},e.writeBuffer=function(){e.imageData.data.set(e.buf8),e.context.putImageData(e.imageData,0,0)},e.fitInParent=function(){var t=e.canvas.parentNode,n=t.clientWidth,a=t.clientHeight;256/240<n/a?(e.canvas.style.width="".concat(Math.round(a*(256/240)),"px"),e.canvas.style.height="".concat(a,"px")):(e.canvas.style.width="".concat(n,"px"),e.canvas.style.height="".concat(Math.round(n/(256/240)),"px"))},e.handleMouseDown=function(t){if(e.props.onMouseDown){var n=256/parseFloat(e.canvas.style.width),a=e.canvas.getBoundingClientRect(),o=Math.round((t.clientX-a.left)*n),r=Math.round((t.clientY-a.top)*n);e.props.onMouseDown(o,r)}},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("canvas",{className:"Screen",width:256,height:240,onMouseDown:this.handleMouseDown,onMouseUp:this.props.onMouseUp,ref:function(t){e.canvas=t}})}},{key:"componentDidMount",value:function(){this.initCanvas()}},{key:"componentDidUpdate",value:function(){this.initCanvas()}},{key:"initCanvas",value:function(){this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,256,240),this.context.fillStyle="black",this.context.fillRect(0,0,256,240),this.buf=new ArrayBuffer(this.imageData.data.length),this.buf8=new Uint8ClampedArray(this.buf),this.buf32=new Uint32Array(this.buf);for(var e=0;e<this.buf32.length;++e)this.buf32[e]=4278190080}},{key:"screenshot",value:function(){var e=new Image;return e.src=this.canvas.toDataURL("image/png"),e}}]),n}(r.Component)),j=n(43),x=n.n(j),z=function(e,t){console.error(e),o.a.captureException(e,{extra:t})};var G=function(){function e(t){var n=this,a=t.onBufferUnderrun;Object(c.a)(this,e),this.writeSample=function(e,t){n.buffer.size()/2>=n.bufferSize&&(console.log("Buffer overrun"),n.buffer.deqN(n.bufferSize/2)),n.buffer.enq(e),n.buffer.enq(t)},this.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),a=e.outputBuffer.getChannelData(1),o=t.length;n.buffer.size()<2*o&&n.onBufferUnderrun&&n.onBufferUnderrun(n.buffer.size(),2*o);try{var r=n.buffer.deqN(2*o)}catch(e){var l=n.buffer.size()/2;l>0&&console.log("Buffer underrun (needed ".concat(o,", got ").concat(l,")"));for(var i=0;i<o;i++)t[i]=0,a[i]=0;return}for(var s=0;s<o;s++)t[s]=r[2*s],a[s]=r[2*s+1]},this.onBufferUnderrun=a,this.bufferSize=8192,this.buffer=new x.a(2*this.bufferSize)}return Object(d.a)(e,[{key:"getSampleRate",value:function(){if(!window.AudioContext)return 44100;var e=new window.AudioContext,t=e.sampleRate;return e.close(),t}},{key:"start",value:function(){window.AudioContext&&(this.audioCtx=new window.AudioContext,this.scriptNode=this.audioCtx.createScriptProcessor(1024,0,2),this.scriptNode.onaudioprocess=this.onaudioprocess,this.scriptNode.connect(this.audioCtx.destination))}},{key:"stop",value:function(){this.scriptNode&&(this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode.onaudioprocess=null,this.scriptNode=null),this.audioCtx&&(this.audioCtx.close().catch(z),this.audioCtx=null)}}]),e}(),K=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).start=function(){e.frameTimer.start(),e.speakers.start(),e.fpsInterval=setInterval((function(){console.log("FPS: ".concat(e.nes.getFPS()))}),1e3)},e.stop=function(){e.frameTimer.stop(),e.speakers.stop(),clearInterval(e.fpsInterval)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement(L,{ref:function(t){e.screen=t},onGenerateFrame:function(){e.nes.frame()},onMouseDown:function(t,n){e.nes.zapperMove(t,n),e.nes.zapperFireDown()},onMouseUp:function(){e.nes.zapperFireUp()}})}},{key:"componentDidMount",value:function(){var e=this;this.fitInParent(),this.speakers=new G({onBufferUnderrun:function(t,n){e.props.paused||(console.log("Buffer underrun, running another frame to try and catch up"),e.frameTimer.generateFrame(),e.speakers.buffer.size()<n&&(console.log("Still buffer underrun, running a second frame"),e.frameTimer.generateFrame()))}}),this.nes=new U.NES({onFrame:this.screen.setBuffer,onStatusUpdate:console.log,onAudioSample:this.speakers.writeSample,sampleRate:this.speakers.getSampleRate()}),window.nes=this.nes,this.frameTimer=new I({onGenerateFrame:o.a.wrap(this.nes.frame),onWriteFrame:o.a.wrap(this.screen.writeBuffer)}),this.gamepadController=new _({onButtonDown:this.nes.buttonDown,onButtonUp:this.nes.buttonUp}),this.gamepadController.loadGamepadConfig(),this.gamepadPolling=this.gamepadController.startPolling(),this.keyboardController=new R({onButtonDown:this.gamepadController.disableIfGamepadEnabled(this.nes.buttonDown),onButtonUp:this.gamepadController.disableIfGamepadEnabled(this.nes.buttonUp)}),this.keyboardController.loadKeys(),document.addEventListener("keydown",this.keyboardController.handleKeyDown),document.addEventListener("keyup",this.keyboardController.handleKeyUp),document.addEventListener("keypress",this.keyboardController.handleKeyPress),this.nes.loadROM(this.props.romData),this.start()}},{key:"componentWillUnmount",value:function(){this.stop(),document.removeEventListener("keydown",this.keyboardController.handleKeyDown),document.removeEventListener("keyup",this.keyboardController.handleKeyUp),document.removeEventListener("keypress",this.keyboardController.handleKeyPress),this.gamepadPolling.stop(),window.nes=void 0}},{key:"componentDidUpdate",value:function(e){this.props.paused!==e.paused&&(this.props.paused?this.stop():this.start())}},{key:"fitInParent",value:function(){this.screen.fitInParent()}}]),n}(r.Component),W=(n(74),function(e){var t;return{touchStartHandler:function(n){var a=window.nes;n.persist(),t=n.target.style.fill,a.buttonDown(e[0],e[1]),n.target.style.fill="#00FF00",n.preventDefault()},touchEndHandler:function(n){var a=window.nes;n.persist(),a.buttonUp(e[0],e[1]),n.target.style.fill=t,n.preventDefault()}}}),V={scalePercentage:100,dPadUp:W([1,U.Controller.BUTTON_UP]),dPadDown:W([1,U.Controller.BUTTON_DOWN]),dPadRight:W([1,U.Controller.BUTTON_RIGHT]),dPadLeft:W([1,U.Controller.BUTTON_LEFT]),a:W([1,U.Controller.BUTTON_A]),b:W([1,U.Controller.BUTTON_B]),start:W([1,U.Controller.BUTTON_START]),select:W([1,U.Controller.BUTTON_SELECT])},q=(W([2,U.Controller.BUTTON_UP]),W([2,U.Controller.BUTTON_DOWN]),W([2,U.Controller.BUTTON_RIGHT]),W([2,U.Controller.BUTTON_LEFT]),W([2,U.Controller.BUTTON_A]),W([2,U.Controller.BUTTON_B]),W([2,U.Controller.BUTTON_START]),W([2,U.Controller.BUTTON_SELECT]),function(e){var t=e.scalePercentage,n=e.dPadUp,a=e.dPadDown,o=e.dPadLeft,r=e.dPadRight,i=e.a,s=e.b,c=e.select,d=e.start,u=e.innerRef;return l.a.createElement("div",{className:"NesController",ref:u},l.a.createElement("svg",{version:"1.1",id:"svg2",xmlns:"http://www.w3.org/2000/svg",width:"".concat(t,"%"),height:"".concat(t,"%"),viewBox:"-0.004 270.034 612.002 251.924",enableBackground:"new -0.004 270.034 612.002 251.924"},l.a.createElement("switch",null,l.a.createElement("g",null,l.a.createElement("g",null,l.a.createElement("rect",{id:"controllerBackground",x:"15.947",y:"311.988",fill:"#1A1A1A",width:"581.833",height:"195.284"}),l.a.createElement("path",{id:"greyStripe1",fill:"#808080",d:"M205.958,305.043h153.281c5.362,0,9.709,4.347,9.709,9.709v10.594 c0,5.362-4.347,9.709-9.709,9.709H205.958c-5.362,0-9.709-4.347-9.709-9.709v-10.594 C196.25,309.39,200.597,305.043,205.958,305.043z"}),l.a.createElement("path",{id:"greyStripe2a",fill:"#808080",d:"M205.958,343.667h153.281c5.362,0,9.709,4.347,9.709,9.708v10.594 c0,5.362-4.347,9.709-9.709,9.709H205.958c-5.362,0-9.709-4.347-9.709-9.709v-10.594 C196.25,348.014,200.597,343.667,205.958,343.667z"}),l.a.createElement("path",{id:"greyStripe4",fill:"#808080",d:"M205.958,488.063h153.281c5.362,0,9.709,4.347,9.709,9.709v10.594 c0,5.362-4.347,9.709-9.709,9.709H205.958c-5.362,0-9.709-4.347-9.709-9.709v-10.594 C196.25,492.409,200.597,488.063,205.958,488.063z"}),l.a.createElement("path",{id:"greyPlasticShell",fill:"#DCDCDC",d:"M8.147,270.034c-4.508,0-8.152,3.644-8.152,8.152v235.621 c0,4.508,3.645,8.152,8.152,8.151h595.897c4.508,0,7.953-3.644,7.953-8.151V278.186c0-4.508-3.445-8.152-7.953-8.152H8.147 L8.147,270.034z M15.902,311.988h581.986v195.25H15.902V311.988L15.902,311.988z"}),l.a.createElement("path",{id:"dPadOutline",stroke:"#FFFFFF",strokeWidth:"1.6523",strokeLinecap:"round",d:"M87.542,362.004 c-2.686,0-4.713,2.216-4.713,4.902v33.747H49.082c-2.686,0-4.902,2.217-4.902,4.902v27.148c0,2.686,2.216,4.901,4.902,4.901 h33.747v33.747c0,2.686,2.028,4.714,4.713,4.714h27.337c2.686,0,4.713-2.027,4.713-4.714v-33.747h33.747 c2.686,0,4.902-2.216,4.902-4.901v-27.148c0-2.686-2.216-4.902-4.902-4.902h-33.747v-33.747c0-2.686-2.028-4.902-4.713-4.902 H87.542z"}),l.a.createElement("path",{id:"dPad",fill:"#1A1A1A",d:"M88.484,366.254c-0.85,0-1.506,0.657-1.506,1.506v36.832H50.146 c-0.849,0-1.506,0.656-1.506,1.506v25.948c0,0.85,0.657,1.574,1.506,1.574h36.832v36.765c0,0.849,0.657,1.574,1.506,1.574H114.5 c0.85,0,1.506-0.726,1.506-1.574V433.62h36.832c0.85,0,1.506-0.725,1.506-1.574v-25.948c0-0.85-0.657-1.506-1.506-1.506h-36.832 V367.76c0-0.85-0.656-1.506-1.506-1.506H88.484z"}),l.a.createElement("rect",{id:"dPadUpTouchPad",fill:"#1A1A1A",x:"86",y:"365",height:"35",width:"30",onTouchCancel:null===n||void 0===n?void 0:n.touchEndHandler,onTouchEnd:null===n||void 0===n?void 0:n.touchEndHandler,onTouchStart:null===n||void 0===n?void 0:n.touchStartHandler}),l.a.createElement("rect",{id:"dPadDownTouchPad",fill:"#1A1A1A",x:"86",y:"438",height:"35",width:"30",onTouchCancel:null===a||void 0===a?void 0:a.touchEndHandler,onTouchEnd:null===a||void 0===a?void 0:a.touchEndHandler,onTouchStart:null===a||void 0===a?void 0:a.touchStartHandler}),l.a.createElement("rect",{id:"dPadLeftTouchPad",fill:"#1A1A1A",x:"48",y:"404",height:"30",width:"35",onTouchStart:null===o||void 0===o?void 0:o.touchStartHandler,onTouchCancel:null===o||void 0===o?void 0:o.touchEndHandler,onTouchEnd:null===o||void 0===o?void 0:o.touchEndHandler}),l.a.createElement("rect",{id:"dPadRigthTouchPad",fill:"#1A1A1A",x:"120",y:"404",height:"30",width:"35",onTouchCancel:null===r||void 0===r?void 0:r.touchEndHandler,onTouchEnd:null===r||void 0===r?void 0:r.touchEndHandler,onTouchStart:null===r||void 0===r?void 0:r.touchStartHandler}),l.a.createElement("g",{id:"g12011",transform:"matrix(2.9042238,0,0,2.9042238,-597.29495,-994.37335)"},l.a.createElement("path",{id:"bButtonBorder",fill:"#DDDDDD",d:"M343.472,484.842h20.578c0.908,0,1.643,0.736,1.643,1.643v20.578 c0,0.907-0.735,1.643-1.643,1.643h-20.578c-0.908,0-1.643-0.736-1.643-1.643v-20.578 C341.829,485.577,342.565,484.842,343.472,484.842z"}),l.a.createElement("path",{id:"bButton",fill:"#FF0000",d:"M363.54,496.875c0,5.402-4.379,9.78-9.78,9.78s-9.78-4.379-9.78-9.78 s4.379-9.78,9.78-9.78S363.54,491.473,363.54,496.875z",onTouchCancel:null===s||void 0===s?void 0:s.touchEndHandler,onTouchEnd:null===s||void 0===s?void 0:s.touchEndHandler,onTouchStart:null===s||void 0===s?void 0:s.touchStartHandler})),l.a.createElement("g",{id:"g12007",transform:"matrix(2.9042238,0,0,2.9042238,-597.29495,-994.37335)"},l.a.createElement("path",{id:"aButtonBorder",fill:"#DDDDDD",d:"M370.572,484.842h20.578c0.907,0,1.643,0.736,1.643,1.643v20.578 c0,0.907-0.736,1.643-1.643,1.643h-20.578c-0.908,0-1.643-0.736-1.643-1.643v-20.578 C368.929,485.577,369.665,484.842,370.572,484.842z"}),l.a.createElement("path",{id:"aButton",fill:"#FF0000",d:"M390.65,496.875c0,5.402-4.379,9.78-9.78,9.78c-5.402,0-9.781-4.379-9.781-9.78 s4.379-9.78,9.781-9.78C386.271,487.094,390.65,491.473,390.65,496.875z",onTouchCancel:null===i||void 0===i?void 0:i.touchEndHandler,onTouchEnd:null===i||void 0===i?void 0:i.touchEndHandler,onTouchStart:null===i||void 0===i?void 0:i.touchStartHandler,onMouseDown:null===i||void 0===i?void 0:i.touchStartHandler,onMouseUp:null===i||void 0===i?void 0:i.touchEndHandler})),l.a.createElement("path",{id:"selectStartTextBackground",fill:"#808080",d:"M205.958,382.312h153.281c5.362,0,9.709,4.347,9.709,9.709v10.594 c0,5.362-4.347,9.709-9.709,9.709H205.958c-5.362,0-9.709-4.347-9.709-9.709v-10.594 C196.249,386.659,200.597,382.312,205.958,382.312z"}),l.a.createElement("path",{id:"selectStartButtonBackground",fill:"#DDDDDD",d:"M207.071,420.454h151.087c5.976,0,10.82,4.845,10.82,10.821v35.343 c0,5.977-4.845,10.821-10.82,10.821H207.071c-5.977,0-10.821-4.845-10.821-10.821v-35.343 C196.249,425.299,201.094,420.454,207.071,420.454z"}),l.a.createElement("path",{id:"selectStartButtonBackgroundBorder",fill:"none",stroke:"#808080",strokeWidth:"1.4584",strokeLinecap:"round",d:"M212.19,425.887h140.876 c4.896,0,8.864,3.969,8.864,8.864v28.951c0,4.896-3.969,8.863-8.864,8.863H212.19c-4.896,0-8.864-3.968-8.864-8.863v-28.951 C203.326,429.856,207.294,425.887,212.19,425.887z"}),l.a.createElement("path",{id:"rect4247",d:"M225.68,440.412h29.395c5.28,0,9.56,4.28,9.56,9.561l0,0c0,5.279-4.28,9.56-9.56,9.56H225.68 c-5.28,0-9.56-4.28-9.56-9.56l0,0C216.12,444.692,220.4,440.412,225.68,440.412z"}),l.a.createElement("path",{id:"rect5332",d:"M309.676,440.412h29.395c5.28,0,9.561,4.28,9.561,9.561l0,0c0,5.279-4.28,9.56-9.561,9.56h-29.395 c-5.28,0-9.561-4.28-9.561-9.56l0,0C300.115,444.692,304.395,440.412,309.676,440.412z"}),l.a.createElement("g",{id:"nintendoText"},l.a.createElement("path",{id:"path6991",fill:"#FE0016",d:"M429.575,346.888v15.725h-5.008l-6.401-10.653c-0.354-0.699-0.354-0.014-0.354-0.014 v10.667h-5.125v-15.725h5.125c0,0,6.106,10.071,6.44,10.544c0.314,0.474,0.314,0,0.314,0v-10.544H429.575"}),l.a.createElement("path",{id:"path6995",fill:"#FE0016",d:"M432.127,349.752h4.692v-2.865h-4.692V349.752z"}),l.a.createElement("path",{id:"path6999",fill:"#FE0016",d:"M461.759,349.205v1.705h2.101l0.079,1.037h-2.18v10.667h-4.89v-10.667h-2.199l0.06-1.037 h2.14v-1.705H461.759"}),l.a.createElement("path",{id:"path7003",fill:"#FE0016",d:"M452.47,352.47c1.178,0.938,1.59,2.751,1.59,2.751v7.391h-4.929v-7.267 c0,0-0.373-1.716-2.297-1.705c-1.904,0.012-2.277,1.581-2.277,1.581v7.391h-4.812v-10.666h4.812 c0.49,0.915,1.649-0.183,2.65-0.354C449.033,351.008,451.017,351.593,452.47,352.47"}),l.a.createElement("path",{id:"path7007",fill:"#FE0016",d:"M432.127,362.612h4.692v-10.667h-4.692V362.612z"}),l.a.createElement("path",{id:"path7011",fill:"#FE0016",d:"M473.089,360.845c0,0-0.433,1.463-1.983,1.463c-1.552,0-1.905-1.646-1.905-1.646 l0.06-3.232h8.935c-0.021-2.985-1.276-4.143-2.298-4.876c-3.004-1.646-7.266-1.62-10.191,0.719 c-1.021,0.878-1.747,2.488-1.669,4.023c0,1.39,0.569,2.778,1.532,3.731c1.904,1.608,4.752,2.338,7.54,1.755 c1.826-0.585,4.163-1.463,4.673-3.511h-4.673L473.089,360.845L473.089,360.845z M469.357,354.088c0,0,0.314-1.412,1.904-1.412 c1.571,0,1.768,1.549,1.768,1.549l0.039,1.438h-3.711V354.088"}),l.a.createElement("path",{id:"path7015",fill:"#FE0016",d:"M504.899,346.886v5.471c-1.61-0.878-4.301-1.424-5.989-0.326 c-2.121,1.023-2.848,3.438-2.926,5.559c0.078,1.608,1.021,3.436,2.415,4.389c1.748,1.068,4.084,1.221,6.048,0.404 c0.177-0.079,0.373-0.163,0.53-0.259c0.157,0.122,0.354,0.218,0.569,0.295c1.395,0.483,3.868,0.194,3.868,0.194v-15.727H504.899 L504.899,346.886z M504.899,360.708c0,0-0.491,1.039-1.886,1.051c-1.1-0.012-1.846-0.792-1.846-0.792v-7.01 c0,0,0.314-0.988,1.729-0.974c1.414,0.01,2.003,0.974,2.003,0.974V360.708"}),l.a.createElement("path",{id:"path7019",fill:"#FE0016",d:"M492.92,352.512c1.159,0.938,1.591,2.751,1.591,2.751v7.391h-4.948v-7.268 c0,0-0.373-1.716-2.278-1.704c-1.924,0.014-2.277,1.581-2.277,1.581v7.391h-4.831v-10.667h4.831 c0.471,0.915,1.63-0.183,2.631-0.352C489.464,351.049,491.447,351.636,492.92,352.512"}),l.a.createElement("path",{id:"path7023",fill:"#FE0016",d:"M518.625,351.276c-3.967,0-7.167,2.606-7.167,5.82c0,3.212,3.2,5.818,7.167,5.818 c3.946-0.002,7.147-2.606,7.147-5.818C525.772,353.882,522.572,351.276,518.625,351.276z M520.549,360.56 c0,0-0.49,1.039-1.904,1.05c-1.08-0.012-1.826-0.791-1.826-0.791v-7.01c0,0,0.295-0.988,1.708-0.974 c1.414,0.012,2.022,0.974,2.022,0.974V360.56"}),l.a.createElement("path",{id:"path7027",fill:"#FE0016",d:"M527.859,352.205c1.039,0,2.021-0.411,2.765-1.148c0.741-0.74,1.159-1.721,1.159-2.764 c0-1.043-0.418-2.024-1.159-2.764c-0.744-0.737-1.726-1.148-2.765-1.148c-2.17,0-3.924,1.754-3.924,3.912 c0,1.043,0.417,2.024,1.159,2.764C525.838,351.795,526.818,352.205,527.859,352.205L527.859,352.205z M524.708,348.293 c0-0.838,0.328-1.625,0.922-2.217c0.595-0.591,1.397-0.918,2.229-0.918s1.635,0.327,2.229,0.918 c0.564,0.592,0.892,1.379,0.892,2.217c0,1.73-1.397,3.136-3.121,3.136c-0.832,0-1.635-0.327-2.229-0.918 C525.036,349.919,524.708,349.131,524.708,348.293"}),l.a.createElement("path",{id:"path7029",fill:"#FE0016",d:"M527.025,346.697h1.338c0.178,0,0.327,0.027,0.444,0.077 c0.18,0.104,0.299,0.297,0.299,0.579c0,0.262-0.089,0.447-0.237,0.547c-0.149,0.098-0.328,0.152-0.596,0.152h-1.248V346.697 L527.025,346.697z M527.025,350.204v-1.703h1.248c0.208,0,0.388,0.021,0.476,0.071c0.18,0.089,0.269,0.265,0.297,0.523 l0.03,0.66c0,0.158,0,0.262,0.03,0.315c0,0.054,0,0.098,0.03,0.134h0.653v-0.092c-0.089-0.036-0.118-0.115-0.149-0.24 c-0.03-0.075-0.059-0.188-0.059-0.339l-0.03-0.532c0-0.229-0.029-0.397-0.118-0.499c-0.06-0.104-0.179-0.188-0.357-0.25 c0.179-0.092,0.327-0.214,0.417-0.362c0.117-0.155,0.147-0.351,0.147-0.585c0-0.458-0.178-0.77-0.564-0.939 c-0.178-0.089-0.445-0.131-0.742-0.131h-1.843v3.971H527.025"})),l.a.createElement("g",{id:"selectText"},l.a.createElement("path",{id:"path2921",fill:"#FF0000",d:"M205.847,403.028h7.825c2.236,0,3.354-1.025,3.354-3.075c0-2.049-1.118-3.074-3.354-3.074 h-5.589v-1.676h8.943v-2.236h-7.825c-2.236,0-3.354,1.039-3.354,3.118c0,2.02,1.118,3.03,3.354,3.03h5.589v1.677h-8.943V403.028 z"}),l.a.createElement("path",{id:"path2923",fill:"#FF0000",d:"M229.324,403.028h-7.825c-2.235,0-3.354-1.118-3.354-3.354v-6.707h11.179v2.235h-8.943 v1.676h8.943v2.235h-8.943v0.56c0,0.745,0.373,1.118,1.118,1.118h7.825V403.028z"}),l.a.createElement("path",{id:"path2925",fill:"#FF0000",d:"M230.427,392.954v6.707c0,2.235,1.118,3.354,3.353,3.354h7.826v-2.235h-7.826 c-0.745,0-1.118-0.373-1.118-1.118v-6.707H230.427z"}),l.a.createElement("path",{id:"path2927",fill:"#FF0000",d:"M253.903,403.028h-7.825c-2.236,0-3.353-1.118-3.353-3.354v-6.707h11.178v2.235h-8.943 v1.676h8.943v2.235h-8.943v0.56c0,0.745,0.373,1.118,1.118,1.118h7.825V403.028z"}),l.a.createElement("path",{id:"path2929",fill:"#FF0000",d:"M266.204,403.028h-7.825c-2.236,0-3.354-1.118-3.354-3.354v-3.354 c0-2.235,1.118-3.353,3.354-3.353h7.825v2.235h-7.825c-0.746,0-1.118,0.373-1.118,1.118v3.354c0,0.745,0.373,1.118,1.118,1.118 h7.825V403.028z"}),l.a.createElement("path",{id:"path2931",fill:"#FF0000",d:"M267.328,392.954h11.179v2.236h-4.472v7.825h-2.235v-7.825h-4.472V392.954z"})),l.a.createElement("g",{id:"startText"},l.a.createElement("path",{id:"path2934",fill:"#FF0000",d:"M298.659,403.028h7.825c2.236,0,3.352-1.025,3.352-3.075c0-2.049-1.116-3.074-3.352-3.074 h-5.59v-1.676h8.942v-2.236h-7.824c-2.236,0-3.354,1.039-3.354,3.119c0,2.02,1.118,3.029,3.354,3.029h5.589v1.677h-8.943 V403.028z"}),l.a.createElement("path",{id:"path2936",fill:"#FF0000",d:"M310.937,392.954h11.18v2.236h-4.472v7.825h-2.236v-7.825h-4.472V392.954z"}),l.a.createElement("path",{id:"path2938",fill:"#FF0000",d:"M332.187,397.991v-1.677c0-0.746-0.373-1.119-1.118-1.119h-4.471 c-0.746,0-1.118,0.373-1.118,1.119v1.677H332.187z M325.48,400.226v2.795h-2.235v-6.707c0-2.236,1.118-3.354,3.354-3.354h4.471 c2.236,0,3.354,1.118,3.354,3.354v6.707h-2.236v-2.795H325.48z"}),l.a.createElement("path",{id:"path2940",fill:"#FF0000",d:"M337.765,396.867h6.708v-1.677h-6.708V396.867z M337.765,399.102v3.912h-2.234v-10.06 h7.824c2.236,0,3.354,1.021,3.354,3.063c0,0.969-0.16,1.681-0.48,2.135c0.32,0.529,0.48,1.219,0.48,2.068v2.794h-2.235v-2.794 c0-0.745-0.373-1.118-1.118-1.118H337.765z"}),l.a.createElement("path",{id:"path2942",fill:"#FF0000",d:"M347.839,392.954h11.179v2.236h-4.472v7.825h-2.235v-7.825h-4.472V392.954z"})),l.a.createElement("g",{id:"bText"},l.a.createElement("path",{id:"path2945",fill:"#FF0000",d:"M457.062,493.145h8.023v-2.006h-8.023V493.145z M457.062,497.825h8.023v-2.006h-8.023 V497.825z M454.389,500.499v-12.034h9.36c2.674,0,4.011,1.212,4.011,3.637c0,0.99-0.214,1.783-0.642,2.381 c0.428,0.588,0.642,1.377,0.642,2.366c0,2.434-1.337,3.65-4.011,3.65H454.389z"})),l.a.createElement("g",{id:"aText"},l.a.createElement("path",{id:"path2948",fill:"#FF0000",d:"M543.818,494.985v-2.006c0-0.892-0.445-1.337-1.337-1.337h-5.349 c-0.892,0-1.337,0.445-1.337,1.337v2.006H543.818z M535.796,497.659v3.344h-2.675v-8.023c0-2.674,1.338-4.011,4.012-4.011h5.349 c2.674,0,4.011,1.337,4.011,4.011v8.023h-2.674v-3.344H535.796z"})),l.a.createElement("path",{id:"dPadLeftArrow",stroke:"#000000",strokeWidth:"0.5",d:"M63.181,408.339l-5.477,5.478l-5.477,5.477l5.477,5.478 l5.477,5.477v-3.286h10.954v-15.336H63.181V408.339z",onTouchCancel:null===o||void 0===o?void 0:o.touchEndHandler,onTouchEnd:null===o||void 0===o?void 0:o.touchEndHandler,onTouchStart:null===o||void 0===o?void 0:o.touchStartHandler}),l.a.createElement("path",{id:"dPadRightArrow",stroke:"#000000",strokeWidth:"0.5",d:"M139.683,408.339l5.477,5.478l5.477,5.477l-5.477,5.478 l-5.477,5.477v-3.286h-10.954v-15.336h10.954V408.339z",onTouchCancel:null===r||void 0===r?void 0:r.touchEndHandler,onTouchEnd:null===r||void 0===r?void 0:r.touchEndHandler,onTouchStart:null===r||void 0===r?void 0:r.touchStartHandler}),l.a.createElement("path",{id:"dPadUpArrow",stroke:"#000000",strokeWidth:"0.5",d:"M112.276,380.669l-5.477-5.477l-5.477-5.477 l-5.477,5.477l-5.477,5.477h3.286v10.954h15.336v-10.954H112.276z",onTouchCancel:null===n||void 0===n?void 0:n.touchEndHandler,onTouchEnd:null===n||void 0===n?void 0:n.touchEndHandler,onTouchStart:null===n||void 0===n?void 0:n.touchStartHandler}),l.a.createElement("path",{id:"dPadDownArrow",stroke:"#000000",strokeWidth:"0.5",d:"M112.276,458.333l-5.477,5.478l-5.477,5.477 l-5.477-5.477l-5.477-5.478h3.286v-10.954h15.336v10.954H112.276z",onTouchCancel:null===a||void 0===a?void 0:a.touchEndHandler,onTouchEnd:null===a||void 0===a?void 0:a.touchEndHandler,onTouchStart:null===a||void 0===a?void 0:a.touchStartHandler}),l.a.createElement("path",{id:"dPadMiddle",fill:"none",stroke:"#000000",strokeWidth:"0.7366",d:"M114.646,419.111 c0.004,7.26-5.876,13.148-13.136,13.153s-13.148-5.877-13.153-13.136c0-0.006,0-0.012,0-0.018 c-0.005-7.26,5.876-13.148,13.136-13.153c7.259-0.005,13.148,5.876,13.153,13.136 C114.646,419.099,114.646,419.105,114.646,419.111z"}),l.a.createElement("path",{id:"selectButtonInner",fill:"#1A1A1A",d:"M228.2,442.274h24.391c5.28,0,9.56,3.448,9.56,7.702l0,0c0,4.254-4.28,7.702-9.56,7.702 H228.2c-5.28,0-9.56-3.448-9.56-7.702l0,0C218.64,445.722,222.92,442.274,228.2,442.274z",onTouchCancel:null===c||void 0===c?void 0:c.touchEndHandler,onTouchEnd:null===c||void 0===c?void 0:c.touchEndHandler,onTouchStart:null===c||void 0===c?void 0:c.touchStartHandler}),l.a.createElement("path",{id:"startButtonInner",fill:"#1A1A1A",d:"M312.173,442.274h24.392c5.279,0,9.56,3.448,9.56,7.702l0,0c0,4.254-4.28,7.702-9.56,7.702 h-24.392c-5.279,0-9.56-3.448-9.56-7.702l0,0C302.613,445.722,306.893,442.274,312.173,442.274z",onTouchCancel:null===d||void 0===d?void 0:d.touchEndHandler,onTouchEnd:null===d||void 0===d?void 0:d.touchEndHandler,onTouchStart:null===d||void 0===d?void 0:d.touchStartHandler,onMouseUp:null===d||void 0===d?void 0:d.touchEndHandler,onMouseDown:null===d||void 0===d?void 0:d.touchStartHandler}))))))}),J=(n(75),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).load=function(){if(a.props.match.params.slug){var e=a.props.match.params.slug,t=/^local-/.test(e),n=e.split("-")[1],o=t?y.getRomInfoByHash(n):g.ROMS[e];if(!o)return void a.setState({error:"No such ROM: ".concat(e)});if(t){a.setState({romName:o.name});var r=localStorage.getItem("blob-"+n);a.handleLoaded(r)}else a.setState({romName:o.description}),a.currentRequest=function(e,t,n){var a=new XMLHttpRequest;return a.open("GET",e),a.overrideMimeType("text/plain; charset=x-user-defined"),a.onload=function(){if(200===this.status){if(a.responseText.match(/^<!doctype html>/i))return t(new Error("Page not found"));t(null,this.responseText)}else 0===this.status||t(new Error(a.statusText))},a.onerror=function(){t(new Error(a.statusText))},a.onprogress=n,a.send(),a}(o.url,(function(e,t){e?a.setState({error:"Error loading ROM: ".concat(e.message)}):a.handleLoaded(t)}),a.handleProgress)}else if(a.props.location.state&&a.props.location.state.file){var l=new FileReader;l.readAsBinaryString(a.props.location.state.file),l.onload=function(e){a.currentRequest=null,a.handleLoaded(l.result)}}else a.setState({error:"No ROM provided"})},a.handleProgress=function(e){e.lengthComputable&&a.setState({loadedPercent:e.loaded/e.total*100})},a.handleLoaded=function(e){a.setState({running:!0,loading:!1,romData:e})},a.handlePauseResume=function(){a.setState({paused:!a.state.paused})},a.layout=function(){var e=parseFloat(window.getComputedStyle(a.navbar).height);console.log(a.nesController.style.display);var t=window.innerWidth>768?0:parseFloat(window.getComputedStyle(a.nesController).height)+100;a.screenContainer.style.height="".concat(window.innerHeight-e-t,"px"),a.emulator&&a.emulator.fitInParent()},a.toggleControlsModal=function(){a.setState({controlsModalOpen:!a.state.controlsModalOpen})},a.state={romName:null,romData:null,running:!1,paused:!1,controlsModalOpen:!1,loading:!0,loadedPercent:3,error:null},a}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"RunPage"},l.a.createElement("nav",{className:"navbar navbar-expand",ref:function(t){e.navbar=t}},l.a.createElement("ul",{className:"navbar-nav",style:{width:"200px"}},l.a.createElement("li",{className:"navitem"},l.a.createElement(m.b,{to:"/",className:"nav-link"},"\u2039 Back"))),l.a.createElement("ul",{className:"navbar-nav ml-auto mr-auto"},l.a.createElement("li",{className:"navitem"},l.a.createElement("span",{className:"navbar-text mr-3"},this.state.romName))),l.a.createElement("ul",{className:"navbar-nav",style:{width:"200px"}},l.a.createElement("li",{className:"navitem"},l.a.createElement(E.a,{outline:!0,color:"primary",onClick:this.toggleControlsModal,className:"mr-3"},"Controls"),l.a.createElement(E.a,{outline:!0,color:"primary",onClick:this.handlePauseResume,disabled:!this.state.running},this.state.paused?"Resume":"Pause")))),this.state.error?this.state.error:l.a.createElement("div",{className:"screen-container",ref:function(t){e.screenContainer=t}},this.state.loading?l.a.createElement(b.a,{value:this.state.loadedPercent,style:{position:"absolute",width:"70%",left:"15%",top:"48%"}}):this.state.romData?l.a.createElement(K,{romData:this.state.romData,paused:this.state.paused,ref:function(t){e.emulator=t}}):null,this.state.controlsModalOpen&&l.a.createElement(A,{isOpen:this.state.controlsModalOpen,toggle:this.toggleControlsModal,keys:this.emulator.keyboardController.keys,setKeys:this.emulator.keyboardController.setKeys,promptButton:this.emulator.gamepadController.promptButton,gamepadConfig:this.emulator.gamepadController.gamepadConfig,setGamepadConfig:this.emulator.gamepadController.setGamepadConfig})),l.a.createElement(q,Object.assign({},V,{innerRef:function(t){e.nesController=t}})))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.layout),this.layout(),this.load()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.layout),this.currentRequest&&this.currentRequest.abort()}}]),n}(r.Component)),Y=(n(76),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).recordPageview=function(e){var t=e.location;return p.a.pageview(t.pathname),null},a.state={error:null},g.GOOGLE_ANALYTICS_CODE&&p.a.initialize(g.GOOGLE_ANALYTICS_CODE),a}return Object(d.a)(n,[{key:"render",value:function(){return this.state.error?l.a.createElement("div",{className:"container my-4"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("div",{className:"col-md-8"},"Oops - there has been an error. It has been logged to the console."))):l.a.createElement(m.a,{basename:g.BASENAME()},l.a.createElement("div",{className:"App"},l.a.createElement(f.a,{exact:!0,path:"/",component:C}),l.a.createElement(f.a,{exact:!0,path:"/run",component:J}),l.a.createElement(f.a,{exact:!0,path:"/run/:slug",component:J}),l.a.createElement(f.a,{path:"/",render:this.recordPageview})))}},{key:"componentDidCatch",value:function(e,t){this.setState({error:e}),z(e,t)}}]),n}(r.Component));n(77);g.SENTRY_URI&&o.a.config(g.SENTRY_URI).install(),o.a.context((function(){s.a.render(l.a.createElement(Y,null),document.getElementById("root"))}))}},[[45,1,2]]]);
//# sourceMappingURL=main.722a9035.chunk.js.map